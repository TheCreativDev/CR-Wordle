/* Shared Attribute Cells + Flip-Reveal (extracted from css/styles.css)
   Used by: base game, studio-game, developer-studio previews */

@font-face {
    font-family: 'Supercell Magic';
    src: url('../fonts/supercell-magic.ttf') format('truetype');
    font-weight: 400;
    font-style: normal;
    font-display: swap;
}

.guess-cell {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 10px 5px;
    border-radius: var(--guess-cell-radius, 8px);
    font-size: 0.9rem;
    font-weight: 500;
    text-align: center;
    min-height: var(--guess-cell-min-height, 100px);
    transition: all 0.3s ease;
}

/* ===== Sequential Flip-Reveal (attribute cells only) ===== */
.reveal-stagger {
    --reveal-delay: 0ms;
    --reveal-duration: 450ms;
}

/* Flip cells */
.guess-cell.guess-attr {
    padding: 0;
    background: transparent;
    perspective: 900px;
    height: var(--guess-cell-min-height, 100px);
    min-height: var(--guess-cell-min-height, 100px);
}

.guess-cell.guess-attr .flip-inner {
    position: relative;
    width: 100%;
    height: var(--guess-cell-min-height, 100px);
    min-height: var(--guess-cell-min-height, 100px);
    transform-style: preserve-3d;
    transform: rotateY(0deg);
}

.guess-cell.guess-attr .guess-face {
    position: absolute;
    inset: 0;
    border-radius: var(--guess-cell-radius);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 10px 5px;
    backface-visibility: hidden;
}

.guess-cell.guess-attr .guess-face.front {
    background: rgba(15, 52, 96, 0.6);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.0);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.guess-cell.guess-attr .guess-face.back {
    transform: rotateY(180deg);
    box-shadow: var(--guess-cell-shadow);
    border: var(--guess-cell-border-width) solid transparent;
    font-family: var(--attr-font-family, inherit);
    font-size: var(--attr-font-size, inherit);
    font-weight: var(--attr-font-weight, inherit);
    overflow: hidden;
}

/* Arrow watermark (higher/lower indicator)
   - Only for incorrect cells
   - Behind the label
   - Centered and large
   - Does not affect label centering */
.guess-cell.guess-attr .guess-face.back .arrow {
    display: none;
}

.guess-cell.guess-attr .guess-face.back.incorrect .arrow {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: var(--attr-font-family, inherit);
    font-size: var(--attr-arrow-size, 72px);
    line-height: 1;
    color: var(--attr-arrow-color, rgba(0, 0, 0, 0.35));
    opacity: calc(var(--attr-arrow-opacity, 35) / 100);
    z-index: 0;
    pointer-events: none;
}

.guess-cell.guess-attr .guess-face.back > :not(.arrow) {
    position: relative;
    z-index: 1;
}

/* Back-face states (reuse existing theme colors) */
.guess-cell.guess-attr .guess-face.back.correct {
    background: var(--attr-correct-bg, var(--correct-green));
    border-color: var(--attr-correct-border, var(--correct-green));
    color: var(--attr-font-color, white);
    box-shadow: 0 4px 16px rgba(46, 204, 113, 0.35);
}

.guess-cell.guess-attr .guess-face.back.incorrect {
    background: var(--attr-incorrect-bg, var(--incorrect-red));
    border-color: var(--attr-incorrect-border, var(--incorrect-red));
    color: var(--attr-font-color, white);
    box-shadow: 0 4px 16px rgba(231, 76, 60, 0.35);
}

.guess-cell.guess-attr .guess-face.back.na {
    background: rgba(15, 52, 96, 0.7);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    border-color: rgba(255, 255, 255, 0.1);
    color: var(--text-secondary);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

/* Trigger flip with staggered delay */
.guess-cell.guess-attr.reveal .flip-inner {
    animation-duration: var(--reveal-duration);
    animation-timing-function: cubic-bezier(0.2, 0.8, 0.2, 1);
    animation-fill-mode: forwards;
    animation-delay: var(--reveal-delay);
    animation-name: flipRevealY;
}

body.reveal-style-flip-x .guess-cell.guess-attr.reveal .flip-inner {
    animation-name: flipRevealX;
}

body.reveal-style-flip-y-pop .guess-cell.guess-attr.reveal .flip-inner {
    animation-name: flipRevealYPop;
}

@keyframes flipRevealY {
    0% { transform: rotateY(0deg); }
    100% { transform: rotateY(180deg); }
}

@keyframes flipRevealX {
    0% { transform: rotateX(0deg); }
    100% { transform: rotateX(180deg); }
}

@keyframes flipRevealYPop {
    0% { transform: rotateY(0deg) scale(1); }
    60% { transform: rotateY(120deg) scale(1.04); }
    100% { transform: rotateY(180deg) scale(1); }
}

/* Disabled category: no flip; appear on schedule */
.guess-cell.disabled-category.reveal-no-flip {
    opacity: 0;
    transform: scale(0.98);
}

.guess-cell.disabled-category.reveal-no-flip.reveal {
    animation: revealFade var(--reveal-duration) ease forwards;
    animation-delay: var(--reveal-delay);
}

@keyframes revealFade {
    0% { opacity: 0; transform: scale(0.98); }
    100% { opacity: 0.6; transform: scale(1); }
}

/* Card image cell */
.guess-cell.card-cell {
    background: transparent;
    padding: 0;
    border-radius: 0;
    height: var(--guess-cell-min-height, 100px);
    min-height: var(--guess-cell-min-height, 100px);
    justify-content: center;
    align-items: center;
}

.guess-cell.card-cell img {
    width: auto;
    height: 100%;
    max-width: 100%;
    object-fit: contain;
    border-radius: 0;
    display: block;
}

.guess-cell.card-cell .card-name {
    display: none;
}

/* Correct / Incorrect states (non-flip fallback) */
.guess-cell.correct {
    background: var(--correct-green);
    color: white;
}

.guess-cell.incorrect {
    background: var(--incorrect-red);
    color: white;
}

.guess-cell.na {
    background: var(--bg-card);
    color: var(--text-secondary);
}

/* Arrow indicators */
.guess-cell .arrow {
    display: none;
}

.guess-cell.incorrect {
    position: relative;
    overflow: hidden;
}

.guess-cell.incorrect .arrow {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: var(--attr-font-family, inherit);
    font-size: var(--attr-arrow-size, 72px);
    line-height: 1;
    color: var(--attr-arrow-color, rgba(0, 0, 0, 0.35));
    opacity: calc(var(--attr-arrow-opacity, 35) / 100);
    z-index: 0;
    pointer-events: none;
}

.guess-cell.incorrect > :not(.arrow) {
    position: relative;
    z-index: 1;
}

/* Disabled category cells */
.guess-cell.disabled-category {
    background: #2a2a2a;
    color: #555;
    position: relative;
    opacity: 0.6;
    border-radius: var(--guess-cell-radius);
    box-shadow: var(--guess-cell-shadow);
}

.guess-cell.disabled-category::after {
    content: 'âœ—';
    position: absolute;
    font-size: 2rem;
    color: #666;
    font-weight: bold;
}
